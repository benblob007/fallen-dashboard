{% extends "base.html" %}
{% block title %}Member Detail{% endblock %}

{% block content %}
<section class="section">
    <a href="/staff/members" class="btn btn-sm" style="margin-bottom: 16px;">‚Üê Back to Search</a>
    
    {% if not member %}
    <div class="empty-state">
        <h2>Member Not Found</h2>
        <p>No data for this user ID in the database.</p>
    </div>
    {% else %}
    <div class="member-detail-header">
        <h2>{{ member.roblox_username or 'Unknown' }} <span class="uid">({{ member.user_id }})</span></h2>
        {% if member.verified %}<span class="verified-badge">‚úì Verified</span>{% endif %}
    </div>

    <!-- Stats Overview -->
    <div class="stat-grid compact">
        <div class="stat-card"><div class="stat-value">{{ member.level }}</div><div class="stat-label">Level</div></div>
        <div class="stat-card"><div class="stat-value">{{ (member.xp or 0)|fnum }}</div><div class="stat-label">XP</div></div>
        <div class="stat-card"><div class="stat-value">{{ (member.coins or 0)|fnum }}</div><div class="stat-label">Coins</div></div>
        <div class="stat-card"><div class="stat-value">{{ member.elo_rating or 1000 }}</div><div class="stat-label">ELO</div></div>
        <div class="stat-card"><div class="stat-value">{{ (member.messages or 0)|fnum }}</div><div class="stat-label">Messages</div></div>
        <div class="stat-card"><div class="stat-value">{{ (member.voice_time or 0)|ftime }}</div><div class="stat-label">Voice</div></div>
        <div class="stat-card"><div class="stat-value">{{ (member.wins or 0) }}/{{ (member.losses or 0) }}</div><div class="stat-label">Duel W/L</div></div>
        <div class="stat-card"><div class="stat-value">{{ member.raid_participation or 0 }}</div><div class="stat-label">Raids</div></div>
    </div>

    <!-- Warnings -->
    <div class="staff-card full-width">
        <h3>‚ö†Ô∏è Warnings ({{ warnings|length }})</h3>
        {% if warnings %}
        <table class="mini-table">
            <thead><tr><th>ID</th><th>Category</th><th>Reason</th><th>By</th><th>Date</th><th>Active</th></tr></thead>
            <tbody>
                {% for w in warnings %}
                <tr class="{% if not w.active %}inactive{% endif %}">
                    <td>{{ w.id }}</td>
                    <td><span class="warn-cat">{{ w.category }}</span></td>
                    <td>{{ w.reason }}</td>
                    <td>{{ w.moderator_id }}</td>
                    <td>{{ w.created_at.strftime('%b %d, %Y') if w.created_at else '' }}</td>
                    <td>{% if w.active %}üî¥{% else %}‚ö™{% endif %}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p class="empty-text">No warnings on record.</p>
        {% endif %}
    </div>

    <!-- Applications -->
    {% if applications %}
    <div class="staff-card full-width">
        <h3>üìù Applications</h3>
        {% for app in applications %}
        <div class="app-row">
            <span class="app-position">{{ app.position_title or app.position_id }}</span>
            <span class="app-status status-{{ app.status }}">{{ app.status|title }}</span>
            <span class="app-date">{{ app.created_at.strftime('%b %d, %Y') if app.created_at else '' }}</span>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Raw Data -->
    <details class="raw-data">
        <summary>View Raw Data</summary>
        <pre>{{ member }}</pre>
    </details>
    {% endif %}
</section>
{% endblock %}
